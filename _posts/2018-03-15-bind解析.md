---
layout: post
title: bind 解析
subtitle: 高级函数与偏函数 以及bind实现
date: 2018-2-16
author: jacob
header-img: img/post_bg_02.jpg
catalog: true
tags: 
    - call  
    - bind
    - apply
    - this
    - 偏函数
---


## bind 问题


```
var altwrite = document.write;
altwrite("hello");
//1.以上代码有什么问题
//2.正确操作是怎样的
//3.bind()方法怎么实现

VM2523:1 Uncaught ReferenceError: alertW is not defined

altwrite.bind(document)("hello")
altwrite.call(document, "hello")

```
## MDN bind 例子
```
this.num = 9; 
var mymodule = {
  num: 81,
  getNum: function() { return this.num; }
};

module.getNum(); // 81

var getNum = module.getNum;
getNum(); // 9, 因为在这个例子中，"this"指向全局对象

// 创建一个'this'绑定到module的函数
var boundGetNum = getNum.bind(module);
boundGetNum(); // 81
```

## 偏函数（Partial Functions）bind相关知识
>假设有一个参数或变量已经预置的函数A，我们通过调用A来产生一个新的函数B，函数B就是我们说的偏函数。
>维基：在计算机科学中，局部应用是指固定一个函数的一些参数，然后产生另一个更小元的函数。
>什么是元？元是指函数参数的个数，比如一个带有两个参数的函数被称为二元函数。

### 简单偏函数add(2)(3)
```
 function add(a){
     return function(b){
         return a+b;
     }
 }

 add(2)(3)   //5
```
### bind版本 add 固定一个参数 改变this 
```
function add(a, b) {
    return a + b;
}

var addOne = add.bind(null, 1);

addOne(2) // 3
```
### 进化版add (Partial) 不改变this
```
function partial(fn){
    var args = [].slice.call(arguments,1);
    return function(){
         var newArgs = args.concat([].slice.call(arguments));
         return fn.apply(this.newArgs);   
    }
}

```
demo验证：
```
function add(a, b) {
    return a + b + this.value;
}
var addOne = partial(add, 1);

var value = 1;
var obj = {
    value: 2,
    addOne: addOne
}
obj.addOne(2); // ???
// 使用 bind 时，结果为 4
// 使用 partial 时，结果为 5
```
### 偏函数之小应用
```
// 判断类型的小demo
var isType = function(type){
  return function(obj){
    return toString.call(obj)=='[object '+type+']';
  }
};

// 定制新的函数
var isString = isType('String');
var isArray = isType('Array');
var isFunction = isType('Function');

// 测试偏函数
console.log(isString('abc')); // true
console.log(isArray([1, 2])); // true
console.log(isFunction('abc')); // false
```